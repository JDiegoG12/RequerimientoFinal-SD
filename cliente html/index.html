<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Laboratorio Streaming + Reacciones</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- SockJS y STOMP para WebSocket (ponerlos junto a index.html) -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</head>
<body>
<div class="app-container">
    <header class="app-header">
        <h1>Laboratorio de Sistemas Distribuidos</h1>
        <h2>Streaming gRPC-Web + Reacciones en Tiempo Real</h2>
    </header>

    <!-- El reproductor ahora está arriba de los paneles principales -->
    <section class="player-section">
        <div class="player-container">
            <audio id="audio-player" controls></audio>
            <!-- El overlay antiguo ya no es necesario para las burbujas -->
            <div id="reactions-overlay" class="reactions-overlay">
            </div>
        </div>
    </section>

    <main class="app-main">
        <!-- Columna izquierda: datos usuario, canción y reacciones -->
        <section class="left-panel">
            <div class="card">
                <h3>Configuración</h3>
                <label for="nickname">Nickname:</label>
                <!-- Atributo 'required' para validación -->
                <input type="text" id="nickname" placeholder="Ingresa tu nickname" required>

                <label for="titulo-cancion">Título de la canción:</label>
                <!-- Atributo 'required' para validación -->
                <input type="text" id="titulo-cancion" placeholder="cancion1" required>

                <label for="formato-cancion">Formato:</label>
                <select id="formato-cancion">
                    <option value="mp3">mp3</option>
                    <option value="wav">wav</option>
                </select>

                <button id="btn-pedir-cancion">Pedir Canción</button>
            </div>

            <div class="card">
                <h3>Reacciones</h3>
                <p>Envía reacciones mientras escuchas:</p>
                <div class="reactions-buttons">
                    <button class="reaction-btn" data-reaccion="like">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 10v12"></path><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a2 2 0 0 1 3 1.88V5.88z"></path></svg>
                        <span>Like</span>
                    </button>
                    <button class="reaction-btn" data-reaccion="heart">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                        <span>Love</span>
                    </button>
                    <button class="reaction-btn" data-reaccion="fire">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5-2 4.5-3 5.5-1.38.6-2 1.333-2 2.5z"></path><path d="M9 12c-2 2.5-1 4.5 0 5s3 1.5 5-1c-1.256-1.352-1.652-3.23-1.5-5.5.15-2.25 1-4 1-4-1 .5-4 2-4.5 4s-.5 3.5 0 5z"></path><path d="M14.5 14.5c2.5-1.5 3.5-3.5 3-5 .5 2.5-2 4.5-3 5.5-1.38.6-2 1.333-2 2.5A2.5 2.5 0 0 0 14.5 14.5z"></path></svg>
                        <span>Fire</span>
                    </button>
                </div>
                <small>Cada reacción vale $10. Máximo $50 por usuario.</small>
            </div>
        </section>

        <!-- Columna derecha: usuarios y timeline -->
        <section class="right-panel">
            <div class="card">
                <h3>Usuarios Activos</h3>
                <ul id="usuarios-lista" class="usuarios-lista">
                    <!-- Aquí se listarán nicknames activos por canción -->
                </ul>
            </div>

            <div class="card">
                <h3>Línea de Tiempo</h3>
                <div id="log" class="log-panel">
                    <!-- Aquí se escriben logs de audio y reacciones -->
                </div>
            </div>
        </section>
    </main>

    <footer class="app-footer">
        <p>Desarrollado por: Juan Diego Gómez Garcés y Ana Sofía Arango Yanza</p>
    </footer>
</div>

<!-- ================================================================ -->
<!-- Contenedor global para las animaciones de reacción        -->
<!-- Este div se posiciona sobre toda la página.                      -->
<!-- ================================================================ -->
<div id="global-reactions-overlay"></div>


<!-- bundle.js trae cliente_receptor_fragmentos + funciones.js ya empacado -->
<script src="bundle.js"></script>
</body>
</html>